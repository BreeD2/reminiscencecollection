<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth.js"></script>
</head>
<body>

<!-- Signup Form -->
<div id="signup-section">
  <input type="email" id="signup-email" placeholder="Email">
  <input type="password" id="signup-password" placeholder="Password">
  <button onclick="signup()">Sign up</button>
</div>

<!-- Login Form -->
<div id="login-section">
  <input type="email" id="login-email" placeholder="Email">
  <input type="password" id="login-password" placeholder="Password">
  <button onclick="login()">Log in</button>
</div>

<!-- User Info Display -->
<div id="user-info" style="display:none;">
  Welcome, <span id="userName"></span>
  <button onclick="logout()">Logout</button>
</div>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyDlAK0_2IR70q2L4TTdQRE3jkHEC2fRs9Q",
      authDomain: "reminiscence-collection.firebaseapp.com",
      databaseURL: "https://reminiscence-collection-default-rtdb.firebaseio.com",
      projectId: "reminiscence-collection",
      storageBucket: "reminiscence-collection.appspot.com",
      messagingSenderId: "974064770925",
      appId: "1:974064770925:web:6fbcf7df2266829b3f0464",
      measurementId: "G-PJ426H3WZN"
    };
    firebase.initializeApp(firebaseConfig);

    // FirebaseUI Configuration
    var uiConfig = {
      callbacks: {
        signInSuccessWithAuthResult: function(authResult, redirectUrl) {
          return true;
        },
        uiShown: function() {
          document.getElementById('loader').style.display = 'none';
        }
      },
      credentialHelper: firebaseui.auth.CredentialHelper.NONE,
      signInFlow: 'popup',
      signInSuccessUrl: 'https://breed2.github.io/reminiscencecollection//signup/signin/index.html',
      signInOptions: [
        firebase.auth.GoogleAuthProvider.PROVIDER_ID,
        firebase.auth.EmailAuthProvider.PROVIDER_ID,
        firebase.auth.PhoneAuthProvider.PROVIDER_ID
      ],
      tosUrl: 'your-tos-url',
      privacyPolicyUrl: function() {
        window.location.assign('your-privacy-policy-url');
      }
    };
    var ui = new firebaseui.auth.AuthUI(firebase.auth());
    ui.start('#firebaseui-auth-container', uiConfig);

    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        // User is signed in.
        document.getElementById('user-info').style.display = 'block';
        document.getElementById('signup-section').style.display = 'none';
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('userName').textContent = user.email; // Display user email as username
      } else {
        // No user is signed in.
        document.getElementById('user-info').style.display = 'none';
        document.getElementById('signup-section').style.display = 'block';
        document.getElementById('login-section').style.display = 'block';
      }
    });
  });

  function signup() {
    var email = document.getElementById('signup-email').value;
    var password = document.getElementById('signup-password').value;
    firebase.auth().createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
      console.log('Signup successful', userCredential);
    })
    .catch((error) => {
      console.log('Signup error', error.message);
    });
  }

  function login() {
    var email = document.getElementById('login-email').value;
    var password = document.getElementById('login-password').value;
    firebase.auth().signInWithEmailAndPassword(email, password)
    .then((userCredential) => {
      console.log('Login successful', userCredential);
    })
    .catch((error) => {
      console.log('Login error', error.message);
    });
  }

  function logout() {
    firebase.auth().signOut().then(() => {
      console.log('User Logged Out!');
    }).catch((error) => {
      console.error('Sign Out Error', error);
    });
  }
</script>

</body>
</html>
